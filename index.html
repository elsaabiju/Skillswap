<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SkillSwap | Professional Knowledge Network</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Fraunces:ital,opsz,wght@0,9..144,400;0,9..144,700;1,9..144,600&family=Inter:wght@400;500;600;700&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --bg: #F8F9F2;
            --surface: #FFFFFF;
            --primary: #2D6A4F;
            --primary-light: #74C69D;
            --accent-earth: #6D4C41;
            --text-main: #1B4332;
            --text-dim: #52796F;
            --border: rgba(45, 106, 79, 0.1);
        }

        body {
            background-color: var(--bg);
            color: var(--text-main);
            font-family: 'Inter', sans-serif;
            letter-spacing: -0.01em;
            overflow-x: hidden;
        }

        .serif {
            font-family: 'Fraunces', serif;
        }

        .glass {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(12px);
            border: 1px solid var(--border);
            border-radius: 2rem;
        }

        .botanical-gradient {
            background: radial-gradient(circle at 0% 0%, rgba(116, 198, 157, 0.15) 0%, transparent 40%),
                radial-gradient(circle at 100% 100%, rgba(45, 106, 79, 0.08) 0%, transparent 40%);
        }

        .btn-action {
            background: var(--primary);
            color: white;
            transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
            border-radius: 1rem;
        }

        .btn-action:hover {
            box-shadow: 0 10px 25px rgba(45, 106, 79, 0.2);
            transform: translateY(-2px);
            background: #1B4332;
        }

        .role-btn {
            border: 2px solid var(--border);
            transition: all 0.3s ease;
        }

        .role-btn.active {
            border-color: var(--primary);
            background: rgba(45, 106, 79, 0.05);
            color: var(--primary);
        }

        .sp-bar-fill {
            transition: width 1.5s cubic-bezier(0.65, 0, 0.35, 1);
            background: linear-gradient(90deg, var(--primary), var(--primary-light));
        }

        .nav-tab {
            position: relative;
            transition: all 0.3s ease;
            font-weight: 600;
            color: var(--text-dim);
        }

        .nav-tab.active {
            color: var(--primary);
        }

        .nav-tab.active::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 50%;
            transform: translateX(-50%);
            width: 12px;
            height: 4px;
            background: var(--primary);
            border-radius: 99px;
        }

        .hide {
            display: none !important;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-rise {
            animation: slideUp 0.8s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
        }

        .leaf-pill {
            background: rgba(45, 106, 79, 0.05);
            color: var(--primary);
            border: 1px solid rgba(45, 106, 79, 0.1);
        }

        .organic-radius {
            border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%;
        }

        /* Message Bubbles */
        .bubble-in {
            background: white;
            border-radius: 0.2rem 1.5rem 1.5rem 1.5rem;
            border: 1px solid var(--border);
        }

        .bubble-out {
            background: var(--primary);
            color: white;
            border-radius: 1.5rem 1.5rem 0.2rem 1.5rem;
        }

        .xp-popup {
            position: absolute;
            color: var(--primary);
            font-weight: 800;
            pointer-events: none;
            animation: xpFloat 1s ease-out forwards;
            z-index: 100;
        }

        @keyframes xpFloat {
            0% {
                transform: translateY(0);
                opacity: 1;
            }

            100% {
                transform: translateY(-50px);
                opacity: 0;
            }
        }
    </style>
</head>

<body class="botanical-gradient min-h-screen">

    <!-- LANDING VIEW -->
    <section id="view-landing"
        class="min-h-screen flex flex-col items-center justify-center p-6 text-center animate-rise">
        <div class="relative max-w-4xl">
            <div
                class="inline-flex items-center gap-2 px-5 py-2 bg-emerald-100/50 border border-emerald-200 rounded-full text-emerald-800 text-xs font-bold uppercase tracking-widest mb-10">
                ‚ú® THE FUTURE OF KNOWLEDGE EXCHANGE
            </div>

            <h1 class="text-7xl md:text-9xl serif font-black text-emerald-950 tracking-tighter leading-[0.85] mb-8">
                Skill<span class="italic text-emerald-700">Swap.</span>
            </h1>

            <p class="text-xl text-emerald-900/60 max-w-2xl mx-auto leading-relaxed mb-12">
                A sustainable ecosystem for collaborative growth.
                <span class="text-emerald-900 block font-medium mt-2">Nurture your expertise, earn Skill Points (SP),
                    and climb the global ranks.</span>
            </p>

            <div class="flex flex-col sm:flex-row gap-6 justify-center items-center">
                <button onclick="showView('setup')"
                    class="btn-action px-12 py-5 font-bold text-lg w-full sm:w-auto shadow-lg">
                    Initialize Profile
                </button>
                <div class="flex items-center gap-3 text-emerald-800/50 font-semibold italic">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z">
                        </path>
                    </svg>
                    2,400+ Active Members
                </div>
            </div>
        </div>
    </section>

    <!-- SETUP VIEW -->
    <section id="view-setup" class="min-h-screen flex items-center justify-center p-6 hide">
        <div class="glass w-full max-w-2xl p-12 space-y-10 animate-rise shadow-xl border-emerald-100">
            <div class="space-y-3 text-center">
                <h2 class="text-4xl serif font-bold text-emerald-950">Member Onboarding</h2>
                <p id="setup-subtitle" class="text-emerald-800/50 font-medium">Define your status and location to begin
                    matching.</p>
            </div>

            <!-- Role Selection -->
            <div class="grid grid-cols-2 gap-4">
                <button onclick="setRole('Student')" id="role-student"
                    class="role-btn p-6 rounded-2xl flex flex-col items-center gap-2 group active">
                    <span class="text-3xl group-hover:scale-110 transition-transform">üéì</span>
                    <span class="font-bold uppercase text-[10px] tracking-widest">Student / Beginner</span>
                </button>
                <button onclick="setRole('Professional')" id="role-pro"
                    class="role-btn p-6 rounded-2xl flex flex-col items-center gap-2 group">
                    <span class="text-3xl group-hover:scale-110 transition-transform">üíº</span>
                    <span class="font-bold uppercase text-[10px] tracking-widest">Professional / Mentor</span>
                </button>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="space-y-2">
                    <label class="text-[10px] font-bold text-emerald-800/40 uppercase tracking-widest ml-1">Full
                        Name</label>
                    <input id="setup-name"
                        class="w-full bg-emerald-50/50 border border-emerald-100 p-4 rounded-2xl font-semibold text-emerald-950 outline-none focus:border-emerald-400 focus:bg-white transition-all"
                        placeholder="e.g. Elena Vance">
                </div>
                <div class="space-y-2">
                    <label
                        class="text-[10px] font-bold text-emerald-800/40 uppercase tracking-widest ml-1">Location</label>
                    <input id="setup-city"
                        class="w-full bg-emerald-50/50 border border-emerald-100 p-4 rounded-2xl font-semibold text-emerald-950 outline-none focus:border-emerald-400 focus:bg-white transition-all"
                        placeholder="e.g. San Francisco">
                </div>
                <div id="have-field-container" class="space-y-2 hide">
                    <label class="text-[10px] font-bold text-emerald-800/40 uppercase tracking-widest ml-1">Skills You
                        Offer (Mastery)</label>
                    <input id="setup-have"
                        class="w-full bg-emerald-50/50 border border-emerald-100 p-4 rounded-2xl font-semibold text-emerald-950 outline-none focus:border-emerald-400 focus:bg-white transition-all"
                        placeholder="e.g. Design, Python">
                </div>
                <div class="space-y-2">
                    <label class="text-[10px] font-bold text-emerald-800/40 uppercase tracking-widest ml-1">Skills You
                        Seek (To Learn)</label>
                    <input id="setup-want"
                        class="w-full bg-emerald-50/50 border border-emerald-100 p-4 rounded-2xl font-semibold text-emerald-950 outline-none focus:border-emerald-400 focus:bg-white transition-all"
                        placeholder="e.g. Guitar, French">
                </div>
            </div>

            <button onclick="finishSetup()" class="btn-action w-full py-5 rounded-2xl font-bold text-xl shadow-lg">
                Activate Dashboard
            </button>
        </div>
    </section>

    <!-- DASHBOARD VIEW -->
    <section id="view-dashboard" class="max-w-[1440px] mx-auto p-4 md:p-8 space-y-8 hide pb-32">
        <header class="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-8 animate-rise">
            <div class="flex items-center gap-6">
                <div id="user-avatar"
                    class="w-16 h-16 organic-radius bg-emerald-700 flex items-center justify-center font-bold text-2xl text-white shadow-xl">
                    U
                </div>
                <div>
                    <h2 class="text-3xl serif font-black text-emerald-950 leading-tight">Welcome back, <span
                            id="display-name" class="text-emerald-700">Member</span></h2>
                    <p id="display-city"
                        class="text-emerald-800/40 text-xs font-bold uppercase tracking-widest mt-1 flex items-center gap-2">
                        <svg class="w-3 h-3 text-emerald-600" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd"
                                d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z">
                            </path>
                        </svg>
                        <span id="header-location">LOCATION</span> ‚Ä¢ <span id="header-role"
                            class="text-emerald-600">ROLE</span>
                    </p>
                </div>
            </div>

            <div class="flex items-center gap-8 glass p-4 rounded-[2.5rem] bg-white/60">
                <div class="flex items-center gap-4 px-4 border-r border-emerald-100">
                    <div class="text-center">
                        <p class="text-[9px] font-bold text-emerald-800/40 uppercase tracking-widest mb-1">Reputation
                        </p>
                        <span id="user-level" class="text-2xl font-bold serif text-emerald-950 italic">LEVEL 1</span>
                    </div>
                </div>
                <div class="flex-1 lg:w-64 space-y-2 px-4 border-r border-emerald-100">
                    <div class="flex justify-between items-end">
                        <span id="xp-text-detail" class="text-sm font-bold text-emerald-700 italic">250 SP</span>
                        <span class="text-[9px] font-bold text-emerald-800/40 uppercase">TIER PROGRESS</span>
                    </div>
                    <div class="xp-bar-container w-full h-2.5 bg-emerald-100 rounded-full overflow-hidden">
                        <div id="xp-fill" class="sp-bar-fill w-0 h-full"></div>
                    </div>
                </div>
                <div class="flex items-center gap-3 px-4">
                    <div class="w-10 h-10 bg-orange-100 rounded-xl flex items-center justify-center text-orange-600">
                        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                            <path
                                d="M12,18C8.69,18 6,15.31 6,12C6,8.69 8.69,6 12,6C15.31,6 18,8.69 18,12C18,15.31 15.31,18 12,18M12,20C16.42,20 20,16.42 20,12C20,7.58 16.42,4 12,4C7.58,4 4,7.58 4,12C4,16.42 7.58,20 12,20M12,8A4,4 0 0,0 8,12A4,4 0 0,0 12,16A4,4 0 0,0 16,12A4,4 0 0,0 12,8Z" />
                        </svg>
                    </div>
                    <div>
                        <p id="user-streak" class="text-lg font-black text-emerald-950 leading-none">3</p>
                        <p class="text-[9px] font-bold text-emerald-800/40 uppercase tracking-tighter">DAILY STREAK</p>
                    </div>
                </div>
            </div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            <!-- Sidebar -->
            <aside class="lg:col-span-3 space-y-6">
                <div class="glass p-6 rounded-[2rem] space-y-6 bg-white/40 border border-emerald-100">
                    <h3 class="text-xs font-bold text-emerald-800/40 uppercase tracking-widest">Active Swap Hub</h3>
                    <div id="active-swaps-list" class="space-y-4">
                        <!-- Swaps populated via JS -->
                    </div>
                </div>

                <div
                    class="bg-emerald-800 p-6 rounded-[2.5rem] text-white shadow-xl space-y-5 relative overflow-hidden">
                    <div class="absolute -right-6 -bottom-6 w-32 h-32 bg-white/5 rounded-full blur-3xl"></div>
                    <h3 class="text-xs font-bold uppercase tracking-widest opacity-60">Impact Points</h3>
                    <div class="space-y-4">
                        <div onclick="gainXP(event, 50, 'Social Outreach')"
                            class="flex items-center gap-4 p-3 bg-white/5 rounded-2xl cursor-pointer hover:bg-white/10 transition-all border border-white/5">
                            <span class="text-xl">üåø</span>
                            <span class="text-[11px] font-bold">Endorse a Peer <span
                                    class="block opacity-60 text-[9px] mt-0.5">+50 SP</span></span>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Main Content Area -->
            <main id="main-hub" class="lg:col-span-9 space-y-8">
                <!-- Navigation -->
                <div class="flex items-center gap-10 border-b border-emerald-900/5 pb-4">
                    <button onclick="setTab('matches')" id="tab-matches"
                        class="nav-tab active text-sm font-bold uppercase tracking-widest">Recommended Matches</button>
                    <button onclick="setTab('directory')" id="tab-directory"
                        class="nav-tab text-sm font-bold uppercase tracking-widest">Full Network</button>
                    <button onclick="setTab('beginners')" id="tab-beginners"
                        class="nav-tab text-sm font-bold uppercase tracking-widest">Learner Circle</button>
                    <button onclick="setTab('swaps')" id="tab-swaps"
                        class="nav-tab text-sm font-bold uppercase tracking-widest flex items-center gap-2">
                        My Swaps <span id="swap-count"
                            class="bg-emerald-100 text-emerald-800 px-2 py-0.5 rounded-full text-[10px]">0</span>
                    </button>
                </div>

                <div id="content-area" class="grid grid-cols-1 md:grid-cols-2 gap-8 animate-rise"></div>
            </main>
        </div>
    </section>

    <!-- Toast Notifications -->
    <div id="toast-container" class="fixed bottom-10 right-10 z-[100] flex flex-col gap-4"></div>

    <script>
        const NETWORK_POOL = [
            { id: '1', name: 'Sebastian V.', city: 'San Francisco', role: 'Professional', have: ['Python', 'Data Science', 'SQL'], want: ['Figma'], sp: 2840, rating: '4.9', avatar: 'SV', match: 98 },
            { id: '2', name: 'Isabella R.', city: 'London', role: 'Professional', have: ['UI Design', 'Sketching', 'Figma'], want: ['React'], sp: 1450, rating: '4.8', avatar: 'IR', match: 85 },
            { id: '3', name: 'Marcus Sterling', city: 'Toronto', role: 'Professional', have: ['Pitching', 'Leadership'], want: ['Spanish'], sp: 890, rating: '4.7', avatar: 'MS', match: 72 },
            { id: '4', name: 'Aria Thorne', city: 'Berlin', role: 'Professional', have: ['Solidity', 'Blockchain'], want: ['Economics'], sp: 3600, rating: '5.0', avatar: 'AT', match: 94 },
            { id: '5', name: 'Arthur Pen', city: 'New York', role: 'Professional', have: ['Calculus', 'Physics'], want: ['Piano'], sp: 1100, rating: '4.5', avatar: 'AP', match: 65 },
        ];

        const BEGINNER_POOL = [
            { id: 'b1', name: 'Toby Miller', city: 'Seattle', role: 'Student', have: [], want: ['Python', 'Math'], sp: 45, avatar: 'TM', bio: 'Recent high school grad eager to dive into code.' },
            { id: 'b2', name: 'Rina Jain', city: 'Mumbai', role: 'Student', have: [], want: ['Photography', 'Lighting'], sp: 20, avatar: 'RJ', bio: 'Just got my first camera, looking for lighting tips.' },
        ];

        let state = {
            view: 'landing',
            activeTab: 'matches',
            profile: {
                name: '', city: '', have: '', want: '', role: 'Student',
                points: 350, streak: 3, level: 1
            },
            activeSwaps: [],
            currentChat: null
        };

        function showView(viewId) {
            document.querySelectorAll('section').forEach(s => s.classList.add('hide'));
            document.getElementById('view-' + viewId).classList.remove('hide');
            state.view = viewId;
            if (viewId === 'dashboard') {
                updateXPUI();
                renderContent();
                renderSidebarSwaps();
            }
        }

        function setRole(role) {
            state.profile.role = role;
            const haveField = document.getElementById('have-field-container');
            const sub = document.getElementById('setup-subtitle');
            document.getElementById('role-student').classList.toggle('active', role === 'Student');
            document.getElementById('role-pro').classList.toggle('active', role === 'Professional');

            if (role === 'Student') {
                haveField.classList.add('hide');
                sub.innerText = "Beginners focus on finding mentors to guide their learning journey.";
            } else {
                haveField.classList.remove('hide');
                sub.innerText = "Mentors offer their mastery and look for professional peers to swap skills.";
            }
        }

        function finishSetup() {
            const name = document.getElementById('setup-name').value;
            const city = document.getElementById('setup-city').value;
            const want = document.getElementById('setup-want').value;
            const have = document.getElementById('setup-have').value;

            if (!name || !city || !want || (state.profile.role === 'Professional' && !have)) {
                spawnToast("Profile requirements incomplete.", "error");
                return;
            }

            state.profile = { ...state.profile, name, city, have: state.profile.role === 'Student' ? '' : have, want };
            document.getElementById('display-name').innerText = name.split(' ')[0];
            document.getElementById('header-location').innerText = city.toUpperCase();
            document.getElementById('header-role').innerText = state.profile.role.toUpperCase();
            document.getElementById('user-avatar').innerText = name[0].toUpperCase();

            showView('dashboard');
            spawnToast(`Welcome to SkillSwap, ${name}.`);
        }

        function setTab(tabId) {
            state.activeTab = tabId;
            state.currentChat = null;
            document.querySelectorAll('.nav-tab').forEach(b => b.classList.remove('active'));
            const target = document.getElementById('tab-' + tabId);
            if (target) target.classList.add('active');
            renderContent();
        }

        function gainXP(event, amount, source) {
            state.profile.points += amount;
            const level = Math.floor(state.profile.points / 1000) + 1;
            if (level > state.profile.level) {
                state.profile.level = level;
                spawnToast(`LEVEL UP: ${level}!`);
            } else {
                spawnToast(`+${amount} SP: ${source}`);
            }

            const popup = document.createElement('div');
            popup.className = 'xp-popup';
            popup.innerText = `+${amount} SP`;
            popup.style.left = `${event.clientX}px`;
            popup.style.top = `${event.clientY}px`;
            document.body.appendChild(popup);
            setTimeout(() => popup.remove(), 1000);

            updateXPUI();
        }

        function updateXPUI() {
            const points = state.profile.points;
            const level = Math.floor(points / 1000) + 1;
            const progress = (points % 1000) / 1000 * 100;
            document.getElementById('user-level').innerText = `LEVEL ${level}`;
            document.getElementById('xp-fill').style.width = progress + '%';
            document.getElementById('xp-text-detail').innerText = `${points.toLocaleString()} SP`;
            document.getElementById('swap-count').innerText = state.activeSwaps.length;
        }

        function renderSidebarSwaps() {
            const list = document.getElementById('active-swaps-list');
            list.innerHTML = '';
            if (state.activeSwaps.length === 0) {
                list.innerHTML = '<p class="text-[10px] text-emerald-800/30 italic">Connections will appear here.</p>';
                return;
            }
            state.activeSwaps.forEach(swap => {
                const item = document.createElement('div');
                item.className = 'flex items-center gap-3 p-2 bg-white/50 rounded-xl cursor-pointer hover:bg-white transition-all border border-emerald-100';
                item.onclick = () => {
                    setTab('swaps');
                    openChat(swap.id);
                };
                item.innerHTML = `
                    <div class="w-8 h-8 rounded-lg bg-emerald-700 flex items-center justify-center font-bold text-white text-xs">${swap.avatar}</div>
                    <div class="overflow-hidden">
                        <p class="text-[11px] font-bold truncate">${swap.name}</p>
                        <p class="text-[9px] text-emerald-600">Active Match</p>
                    </div>
                `;
                list.appendChild(item);
            });
        }

        function proposeSwap(event, id, poolName) {
            const pool = poolName === 'NETWORK' ? NETWORK_POOL : BEGINNER_POOL;
            const person = pool.find(p => p.id === id);

            if (state.activeSwaps.find(s => s.id === id)) {
                spawnToast("You are already swapping with this member.", "error");
                return;
            }

            state.activeSwaps.push(person);
            gainXP(event, 100, 'Strategic Outreach');
            spawnToast(`Knowledge Swap started with ${person.name}!`);
            renderSidebarSwaps();
            updateXPUI();
            renderContent();
        }

        function openChat(id) {
            state.currentChat = state.activeSwaps.find(s => s.id === id);
            renderContent();
        }

        function renderContent() {
            const area = document.getElementById('content-area');
            area.innerHTML = '';
            area.className = 'grid grid-cols-1 md:grid-cols-2 gap-8 animate-rise';

            // IF MY SWAPS TAB
            if (state.activeTab === 'swaps') {
                if (state.currentChat) {
                    renderChatUI(area);
                } else {
                    area.className = 'col-span-full space-y-4';
                    if (state.activeSwaps.length === 0) {
                        area.innerHTML = `
                            <div class="py-24 text-center glass border border-emerald-100 rounded-[3rem]">
                                <span class="text-4xl block mb-4">üì≠</span>
                                <p class="text-emerald-800/40 serif italic text-xl">Your swap list is currently empty.</p>
                                <button onclick="setTab('matches')" class="mt-4 text-emerald-700 font-bold hover:underline">Find a Mentor or Peer</button>
                            </div>
                        `;
                    } else {
                        state.activeSwaps.forEach(swap => {
                            const card = document.createElement('div');
                            card.className = 'glass p-6 flex items-center justify-between hover:border-emerald-500/30 transition-all cursor-pointer';
                            card.onclick = () => openChat(swap.id);
                            card.innerHTML = `
                                <div class="flex items-center gap-5">
                                    <div class="w-14 h-14 organic-radius bg-emerald-700 flex items-center justify-center text-xl font-bold text-white shadow-md">${swap.avatar}</div>
                                    <div>
                                        <h4 class="font-bold text-lg text-emerald-950">${swap.name}</h4>
                                        <p class="text-xs text-emerald-600 font-medium">Topic: ${swap.have[0] || swap.want[0]}</p>
                                    </div>
                                </div>
                                <div class="flex items-center gap-4">
                                    <span class="text-[10px] font-bold uppercase text-emerald-800/40">Active Session</span>
                                    <button class="btn-action px-6 py-2 text-[10px] font-bold uppercase tracking-widest">Connect</button>
                                </div>
                            `;
                            area.appendChild(card);
                        });
                    }
                }
                return;
            }

            // DYNAMIC DISCOVERY LOGIC
            let pool;
            if (state.activeTab === 'beginners') {
                pool = BEGINNER_POOL;
            } else if (state.activeTab === 'matches') {
                // If user is a student, "Matches" shows Professionals offering what they want
                if (state.profile.role === 'Student') {
                    const myWants = state.profile.want.toLowerCase();
                    pool = NETWORK_POOL.filter(p => p.have.some(h => myWants.includes(h.toLowerCase())));
                } else {
                    // Professionals see high-overlap Professional matches
                    pool = NETWORK_POOL.filter(p => p.match > 80);
                }
            } else {
                pool = NETWORK_POOL;
            }

            if (pool.length === 0) {
                area.innerHTML = `<div class="col-span-full py-20 text-center text-emerald-800/30 serif italic">No members found in this category.</div>`;
                return;
            }

            pool.forEach(peer => {
                const isActive = state.activeSwaps.find(s => s.id === peer.id);
                const card = document.createElement('div');
                card.className = 'glass p-8 rounded-[3rem] space-y-6 relative overflow-hidden group hover:border-emerald-500/30 transition-all bg-white/40';

                // Card Header framing
                let badgeText = state.activeTab === 'beginners' ? 'LEARNER' : (peer.match || 90) + '% AFFINITY';
                if (state.profile.role === 'Student' && peer.role === 'Professional') badgeText = 'READY TO TEACH';

                card.innerHTML = `
                    <div class="absolute top-0 right-0 leaf-pill px-6 py-2 rounded-bl-[2rem] font-bold text-[10px] italic">
                        ${badgeText}
                    </div>
                    <div class="flex items-start gap-5">
                        <div class="w-16 h-16 organic-radius bg-emerald-50 border border-emerald-100 flex items-center justify-center font-bold text-2xl text-emerald-600">${peer.avatar}</div>
                        <div>
                            <h4 class="font-black text-xl serif text-emerald-950 italic group-hover:text-emerald-700 transition-colors">${peer.name}</h4>
                            <p class="text-[10px] font-bold text-emerald-800/40 uppercase tracking-widest mt-1">${peer.city} ‚Ä¢ ${peer.role}</p>
                        </div>
                    </div>
                    <div class="space-y-4">
                        <div class="space-y-2">
                            <p class="text-[9px] font-bold text-emerald-800/30 uppercase tracking-[0.2em]">Mastery</p>
                            <div class="flex flex-wrap gap-2">
                                ${peer.have.length > 0 ? peer.have.map(s => `<span class="bg-emerald-700/5 text-emerald-700 px-3 py-1 rounded-lg text-[10px] font-bold border border-emerald-700/10 italic">${s}</span>`).join('') : '<span class="text-[10px] text-emerald-800/40 italic">Exploring Mastery</span>'}
                            </div>
                        </div>
                        <div class="space-y-2">
                            <p class="text-[9px] font-bold text-emerald-800/30 uppercase tracking-[0.2em]">Seeking</p>
                            <div class="flex flex-wrap gap-2">
                                ${peer.want.map(s => `<span class="bg-slate-100 text-slate-500 px-3 py-1 rounded-lg text-[10px] font-bold border border-slate-200">${s}</span>`).join('')}
                            </div>
                        </div>
                    </div>
                    ${isActive ?
                        `<div class="w-full text-center py-4 bg-emerald-50 rounded-2xl text-emerald-700 font-bold italic text-sm">Swap In Progress ‚úì</div>` :
                        `<button onclick="proposeSwap(event, '${peer.id}', '${state.activeTab === 'beginners' ? 'BEGINNER' : 'NETWORK'}')" class="btn-action w-full py-4 rounded-2xl text-[10px] font-bold uppercase tracking-widest shadow-md">
                            ${state.profile.role === 'Student' ? 'Request Mentorship' : 'Propose Knowledge Swap'}
                        </button>`
                    }
                `;
                area.appendChild(card);
            });
        }

        function renderChatUI(area) {
            area.className = 'col-span-full h-[600px] flex flex-col bg-white/40 border border-emerald-100 rounded-[2.5rem] overflow-hidden animate-rise';
            const swap = state.currentChat;
            area.innerHTML = `
                <div class="p-6 bg-white/80 border-b border-emerald-100 flex items-center justify-between">
                    <div class="flex items-center gap-4">
                        <button onclick="setTab('swaps')" class="text-emerald-700 p-2 hover:bg-emerald-50 rounded-full transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
                        </button>
                        <div class="w-10 h-10 organic-radius bg-emerald-700 flex items-center justify-center font-bold text-white shadow-sm">${swap.avatar}</div>
                        <div>
                            <h4 class="font-bold serif italic text-emerald-950">${swap.name}</h4>
                            <p class="text-[10px] uppercase font-bold text-emerald-600">Swap Interest: ${swap.have[0] || swap.want[0]}</p>
                        </div>
                    </div>
                    <button class="btn-action px-6 py-2 text-[10px] font-bold uppercase tracking-widest bg-emerald-100 !text-emerald-800 border border-emerald-200">Arrange Session</button>
                </div>
                <div class="flex-1 overflow-y-auto p-8 space-y-6 flex flex-col no-scrollbar">
                    <div class="self-start max-w-[70%] p-4 bubble-in text-sm font-medium text-emerald-900 shadow-sm animate-rise">
                        Greetings ${state.profile.name}! I would be honored to guide you through ${swap.have[0] || 'your interests'}. Are you available for a session this week?
                    </div>
                    <div class="self-end max-w-[70%] p-4 bubble-out text-sm font-medium shadow-md animate-rise">
                        Thank you so much! I am very excited. Tuesday or Thursday at the hub works best for me.
                    </div>
                    <div class="self-start max-w-[70%] p-4 bubble-in text-sm font-medium italic text-emerald-800/40">
                        ${swap.name} is preparing a response...
                    </div>
                </div>
                <div class="p-6 bg-white/80 border-t border-emerald-100 flex gap-4">
                    <input type="text" placeholder="Type a message..." class="flex-1 bg-emerald-50/50 border border-emerald-100 p-4 rounded-2xl outline-none focus:border-emerald-400 focus:bg-white transition-all font-medium text-emerald-950">
                    <button onclick="gainXP(event, 25, 'Digital Exchange')" class="btn-action px-8 py-4 font-bold uppercase tracking-widest shadow-md">Send</button>
                </div>
            `;
        }

        function spawnToast(msg, type = "success") {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = `glass px-6 py-4 rounded-2xl shadow-2xl animate-rise border-l-4 ${type === 'success' ? 'border-emerald-500' : 'border-rose-300'} flex items-center gap-4 bg-white`;
            toast.innerHTML = `
                <div class="w-8 h-8 rounded-full bg-emerald-50 flex items-center justify-center text-white">
                    ${type === 'success' ? '‚úì' : '‚ö†Ô∏è'}
                </div>
                <p class="font-bold text-sm text-emerald-950 italic">${msg}</p>
            `;
            container.appendChild(toast);
            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateY(10px)';
                setTimeout(() => toast.remove(), 500);
            }, 4000);
        }

        document.addEventListener('DOMContentLoaded', () => {
            showView('landing');
            setRole('Student');
        });
    </script>
</body>

</html>